<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="ldoSpace">

	<typeAlias alias="LDO" type="com.best.domain.wms.Ldo" />
	<typeAlias alias="SALESDETAIL" type="com.best.domain.SalesOrderDetail" />
	
	<resultMap class="SALESDETAIL" id="DETAIL_PROPERTIES">
		<result property="orderCode" column="ORDER_CODE" />
		<result property="refOrderCode" column="REF_ORDER_CODE" />
		<result property="createTime" column="CREATE_TIME" />
		<result property="shippingTime" column="SHIPPING_TIME" />
		<result property="status" column="STATUS" />
		<result property="province" column="PROVINCE" />
		<result property="city" column="CITY" />
		<result property="district" column="DISTRICT" />
		<result property="address" column="ADDRESS" />
		<result property="name" column="NAME" />
		<result property="phone" column="PHONE" />
		<result property="ldoId" column="LDO_ID" />
	</resultMap>
	
	<resultMap class="SALESDETAIL" id="DETAIL_COMMODITY_PROPERTIES">
		<result property="ldoId" column="LDO_ID" />
		<result property="qtyOrdered" column="QTY_ORDERED" />
	</resultMap>
	
	<resultMap class="SALESDETAIL" id="DETAIL_OTHER_PROPERTIES">
		<result property="orderCode" column="ORDER_CODE" />
		<result property="refOrderCode" column="REF_ORDER_CODE" />
		<result property="createTime" column="CREATE_TIME" />
		<result property="shippingTime" column="SHIPPING_TIME" />
		<result property="status" column="STATUS" />
		<result property="province" column="PROVINCE" />
		<result property="city" column="CITY" />
		<result property="district" column="DISTRICT" />
		<result property="address" column="ADDRESS" />
		<result property="name" column="NAME" />
		<result property="phone" column="PHONE" />
		<result property="ldoId" column="LDO_ID" />
		<result property="orderLineNo" column="ORDER_LINE_NO" />
		<result property="issuePartyCode" column="ISSUE_PARTY_CODE" />
		<result property="customerName" column="CUSTOMER_NAME" />
		<result property="outSideNo" column="OUTSIDE_NO" />
		<result property="grossWeight" column="GROSS_WEIGHT" />
		<result property="qtyOrdered" column="QTY_ORDERED" />
		<result property="cubic" column="CUBIC" />
	</resultMap>

	<resultMap class="LDO" id="ALL_PROPERTIES">
		<result property="id" column="id" />
		<result property="version" column="version" />
		<result property="createTime" column="create_time" />
		<result property="lastUpdateTime" column="last_update_time" />
		<result property="orgCode" column="org_code" />
		<result property="whCode" column="wh_code" />
		<result property="customerCode" column="customer_code" />
		<result property="customerName" column="customer_name" />
		<result property="salesOrderNo" column="salesorder_no" />
		<result property="relationNo" column="relation_no" />
		<result property="orderTypeCode" column="order_type_code" />
		<result property="orderTime" column="order_time" />
		<result property="fmExpectedShipmentTime" column="fm_expected_shipment_time" />
		<result property="toExpectedShipmentTime" column="to_expected_shipment_time" />
		<result property="requiredDeliveryTime" column="required_delivery_time" />
		<result property="soreference1" column="soreference1" />
		<result property="soreference2" column="soreference2" />
		<result property="soreference3" column="soreference3" />
		<result property="soreference4" column="soreference4" />
		<result property="consigneeCode" column="consigneecode" />
		<result property="consigneeName" column="consigneename" />
		<result property="consigneeAddress" column="consignee_address" />
		<result property="consigneeLinkMann" column="consignee_linkmann" />
		<result property="consigneePhone" column="consignee_phone" />
		<result property="consigneeProvince" column="consignee_province" />
		<result property="consigneeCity" column="consignee_city" />
		<result property="consigneeCantonCode" column="consignee_canton_code" />
		<result property="selletementCode" column="selletement_code" />
		<result property="doorCode" column="door_code" />
		<result property="carrierAddress" column="carrier_address" />
		<result property="carrierCode" column="carrier_code" />
		<result property="carrierName" column="carrier_name" />
		<result property="placeOfDischarge" column="place_of_discharge" />
		<result property="placeOfLoading" column="place_of_loading" />
		<result property="placeOfDelivery" column="place_of_delivery" />
		<result property="deliveryVehicleNo" column="delivery_vehicle_no" />
		<result property="vehicleType" column="vehicle_type" />
		<result property="driver" column="driver" />
		<result property="telephone" column="telephone" />
		<result property="deliveryTermsCode" column="delivery_terms_code" />
		<result property="deliveryTermsDescr" column="delivery_terms_descr" />
		<result property="paymentTermsCode" column="payment_terms_code" />
		<result property="paymentTermsDescr" column="payment_terms_descr" />
		<result property="skuItem" column="sku_item" />
		<result property="issueAddress" column="issue_address" />
		<result property="issueLinkMan" column="issue_linkman" />
		<result property="issuePartyCode" column="issue_party_code" />
		<result property="issuePartyName" column="issue_party_name" />
		<result property="issuePhone" column="issue_phone" />
		<result property="priorityCode" column="priority_code" />
		<result property="modeCode" column="mode_code" />
		<result property="reMark" column="re_mark" />
		<result property="statusCode" column="status_code" />
		<result property="udf1" column="udf1" />
		<result property="udf2" column="udf2" />
		<result property="udf3" column="udf3" />
		<result property="udf4" column="udf4" />
		<result property="udf5" column="udf5" />
		<result property="udf6" column="udf6" />
		<result property="udf7" column="udf7" />
		<result property="udf8" column="udf8" />
		<result property="status" column="status" />
		<result property="cancelStatus" column="cancel_status" />
		<result property="sendToWmsStatus" column="send_to_wms_status" />
		<result property="allocateFinishTime" column="allocate_finish_time" />
		<result property="allocatePerson" column="allocate_person" />
		<result property="pickupFinishTime" column="pickup_finish_time" />
		<result property="pickPerson" column="pick_person" />
		<result property="checkFinishTime" column="check_finish_time" />
		<result property="checkPerson" column="check_person" />
		<result property="weighingTime" column="weighing_time" />
		<result property="weighingPerson" column="weighing_person" />
		<result property="shipFinishTime" column="ship_finish_time" />
		<result property="sendPerson" column="sent_person" />
		<result property="boxCodes" column="box_codes" />
		<result property="boxNames" column="box_names" />
		<result property="outsideNo" column="outside_no" />
		<result property="preCarrierCode" column="pre_carrier_code" />
		<result property="consigneeZipCode" column="consignee_zipcode" />
		<result property="totalAmount" column="total_amount" />
		<result property="totalCubic" column="total_cubic" />
		<result property="totalWeight" column="total_weight" />
		<result property="totalNetWeight" column="total_net_weight" />
		<result property="totalPrice" column="total_price" />
		<result property="length" column="length" />
		<result property="width" column="width" />
		<result property="height" column="height" />
		<result property="cubic" column="cubic" />
		<result property="collectionAddress" column="collection_address" />
		<result property="bigHeadPen" column="big_head_pen" />
		<result property="errorTime" column="errortime" />
		<result property="errorNote" column="errornote" />
		<result property="wareHouseAcceptedTime" column="warehouse_accepted_time" />
		<result property="consigneeDistrict" column="consignee_district" />
		<result property="isSettled" column="is_settled" />
		<result property="invoiceContent" column="invoice_content" />
		<result property="invoiceHead" column="invoice_head" />
		<result property="invoicePrice" column="invoice_price" />
		<result property="invoiceCode" column="invoice_code" />
		<result property="ldoType" column="ldo_type" />
		<result property="ldoActiveStatus" column="ldo_active_status" />
		<result property="carrierSelectStatus" column="carrierselectstatus" />
		<result property="carrierSelectType" column="carrierselecttype" />
		<result property="carrierAssignType" column="carrierassigntype" />
		<result property="carrierAssignResult" column="carrierassignresult" />
		<result property="outterOrderTypeCode" column="outterordertypecode" />
		<result property="codPrice" column="codprice" />
		<result property="payPrice" column="payprice" />
		<result property="lackInventoryTag" column="lackinventorytag" />
		<result property="tradeChannel" column="tradechannel" />
		<result property="discountCurrency" column="discountcurrency" />
		<result property="freightCurrency" column="freightcurrency" />
		<result property="expressCollection" column="expresscollection" />
		<result property="stagedSoState" column="stagedsostate" />
		<result property="stagedSoPaidCurrency" column="stagedsopaidcurrency" />
		<result property="paidTime" column="paidtime" />
		<result property="approvePassTime" column="approvepasstime" />
		<result property="isPrintInvoice" column="isprintinvoice" />
		<result property="buyerNickName" column="buyernickname" />
		<result property="email" column="email" />
		<result property="outerSendAddr" column="outersendaddr" />
		<result property="isNoticeBeforeSending" column="isnoticebeforesending" />
		<result property="sendTime" column="sendtime" />
		<result property="partPickCode" column="partpickcode" />
		<result property="deliveryPortName" column="deliveryportname" />
		<result property="expectedReceivedName" column="expectedreceivedname" />
		<result property="estimateArrivedDays" column="estimatearriveddays" />
		<result property="isConnectionBeforeSending" column="isconnectionbeforesending" />
		<result property="isCashOnDelivery" column="iscashondelivery" />
		<result property="packageNum" column="packagenum" />
		<result property="packagePickTag" column="packagepicktag" />
		<result property="wmsCreateTime" column="wmscreatetime" />
		<result property="wmsFulfilledTime" column="wmsfulfilledtime" />
		<result property="wmsClosedTime" column="wmsclosedtime" />
		<result property="freezeStatus" column="freezestatus" />
	</resultMap>

	<select id="GET_DATA" parameterClass="java.util.Map" resultMap="ALL_PROPERTIES">
		<![CDATA[
			SELECT 
				a.id,a.version,to_char(a.CREATE_TIME,'yyyyMMdd') AS create_time,a.last_update_time,a.org_code,a.wh_code,a.customer_code,a.customer_name,a.salesorder_no,a.relation_no,a.order_type_code,a.order_time,a.fm_expected_shipment_time,a.to_expected_shipment_time,a.required_delivery_time,a.soreference1,a.soreference2,a.soreference3,a.soreference4,a.consigneecode,a.consigneename,a.consignee_address,a.consignee_linkmann,a.consignee_phone,a.consignee_province,a.consignee_city,a.consignee_canton_code,a.selletement_code,a.door_code,a.carrier_address,a.carrier_code,a.carrier_name,a.place_of_discharge,a.place_of_loading,a.place_of_delivery,a.delivery_vehicle_no,a.vehicle_type,a.driver,a.telephone,a.delivery_terms_code,a.delivery_terms_descr,a.payment_terms_code,a.payment_terms_descr,a.sku_item,a.issue_address,a.issue_linkman,a.issue_party_code,a.issue_party_name,a.issue_phone,a.priority_code,a.mode_code,a.re_mark,a.status_code,a.udf1,a.udf2,a.udf3,a.udf4,a.udf5,a.udf6,a.udf7,a.udf8,a.status,a.cancel_status,a.send_to_wms_status,a.allocate_finish_time,a.allocate_person,a.pickup_finish_time,a.pick_person,a.check_finish_time,a.check_person,a.weighing_time,a.weighing_person,a.ship_finish_time,a.sent_person,a.box_codes,a.box_names,a.outside_no,a.pre_carrier_code,a.consignee_zipcode,a.total_amount,a.total_cubic,a.total_weight,a.total_net_weight,a.total_price,a.length,a.width,a.height,a.cubic,a.collection_address,a.big_head_pen,a.errortime,a.errornote,a.warehouse_accepted_time,a.consignee_district,a.is_settled,a.invoice_content,a.invoice_head,a.invoice_price,a.invoice_code,a.ldo_type,a.ldo_active_status,a.carrierselectstatus,a.carrierselecttype,a.carrierassigntype,a.carrierassignresult,a.outterordertypecode,a.codprice,a.payprice,a.lackinventorytag,a.tradechannel,a.discountcurrency,a.freightcurrency,a.expresscollection,a.stagedsostate,a.stagedsopaidcurrency,a.paidtime,a.approvepasstime,a.isprintinvoice,a.buyernickname,a.email,a.outersendaddr,a.isnoticebeforesending,a.sendtime,a.partpickcode,a.deliveryportname,a.expectedreceivedname,a.estimatearriveddays,a.isconnectionbeforesending,a.iscashondelivery,a.packagenum,a.packagepicktag,a.wmscreatetime,a.wmsfulfilledtime,a.wmsclosedtime,a.freezestatus
			FROM 
				ECBOSS_LDO a
			WHERE 
				CUSTOMER_CODE=#customerCode# 
			AND 
				WH_CODE=#warehouseCode#
			AND
				CREATE_TIME>=to_date(#startTime#,'yyyyMMdd')
			AND 
				CREATE_TIME<=(to_date(#endTime#,'yyyyMMdd'))						
		]]>
	</select>
	
	<select id="B2B_CANCEL_ORDER" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		<![CDATA[
			SELECT count(id) FROM ECBOSS_LDO_ITEM
			where LDO_ID in (
				SELECT id
					FROM
						ECBOSS_LDO
					WHERE 
							CUSTOMER_CODE=#customerCode#
						AND 
							WH_CODE=#warehouseCode#
						AND
							STATUS='WMS_CANCELED'
						AND 
							MODE_CODE='B2B'
						AND
							CREATE_TIME>=to_date(#startTime#,'yyyyMMdd')
						AND 
							CREATE_TIME<=(to_date(#endTime#,'yyyyMMdd'))
				)
		]]>
		$param$
	</select>
	
	<select id="B2B_CANCEL_ORDER_DISTINCT" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		<![CDATA[
			SELECT count(DISTINCT LDO_ID) FROM ECBOSS_LDO_ITEM
			where LDO_ID in (
				SELECT id
					FROM
						ECBOSS_LDO
					WHERE 
							CUSTOMER_CODE=#customerCode#
						AND 
							WH_CODE=#warehouseCode#
						AND
							STATUS='WMS_CANCELED'
						AND 
							MODE_CODE='B2B'
						AND
							CREATE_TIME>=to_date(#startTime#,'yyyyMMdd')
						AND 
							CREATE_TIME<=(to_date(#endTime#,'yyyyMMdd'))
				)
		]]>
		$param$
	</select>
	
	<select id="B2B_CANCEL_ORDER_DETAIL" parameterClass="java.util.Map" resultMap="DETAIL_OTHER_PROPERTIES">
		<![CDATA[
			SELECT LDO_ID AS LDO_ID,b.RELATION_NO AS REF_ORDER_CODE,b.SALESORDER_NO as ORDER_CODE,b.STATUS AS STATUS,to_char(b.CREATE_TIME,'yyyyMMdd') AS CREATE_TIME,to_char(b.SHIP_FINISH_TIME,'yyyyMMdd') AS SHIPPING_TIME,b.CONSIGNEE_PROVINCE AS PROVINCE,b.CONSIGNEE_CITY AS CITY,b.CONSIGNEE_CANTON_CODE AS DISTRICT,b.CONSIGNEE_ADDRESS AS ADDRESS,b.CONSIGNEE_LINKMANN AS "NAME", b.CONSIGNEE_PHONE AS PHONE,a.ORDER_LINE_NO AS ORDER_LINE_NO,b.ISSUE_PARTY_CODE AS ISSUE_PARTY_CODE,b.CUSTOMER_NAME AS CUSTOMER_NAME,b.OUTSIDE_NO AS OUTSIDE_NO,a.GROSS_WEIGHT AS GROSS_WEIGHT,a.CUBIC AS CUBIC,a.QTY_ORDERED AS QTY_ORDERED
			FROM ECBOSS_LDO_ITEM a JOIN  ECBOSS_LDO b
			ON a.LDO_ID = b.id
			AND 
				CUSTOMER_CODE=#customerCode#
			AND 
				WH_CODE=#warehouseCode#
			AND
				STATUS='WMS_CANCELED'
			AND 
				MODE_CODE='B2B'
			AND
				b.CREATE_TIME>=to_date(#startTime#,'yyyyMMdd')
			AND 
				b.CREATE_TIME<=(to_date(#endTime#,'yyyyMMdd'))
		]]>
		$param$
	</select>
	
	<select id="B2B_CANCEL_ORDER_DETAIL_DISTINCT" parameterClass="java.util.Map" resultMap="DETAIL_PROPERTIES">
		<![CDATA[
			SELECT DISTINCT LDO_ID AS LDO_ID,b.RELATION_NO AS REF_ORDER_CODE,b.SALESORDER_NO as ORDER_CODE,b.STATUS AS STATUS,to_char(b.CREATE_TIME,'yyyyMMdd') AS CREATE_TIME,to_char(b.SHIP_FINISH_TIME,'yyyyMMdd') AS SHIPPING_TIME,b.CONSIGNEE_PROVINCE AS PROVINCE,b.CONSIGNEE_CITY AS CITY,b.CONSIGNEE_CANTON_CODE AS DISTRICT,b.CONSIGNEE_ADDRESS AS ADDRESS,b.CONSIGNEE_LINKMANN AS "NAME", b.CONSIGNEE_PHONE AS PHONE
			FROM ECBOSS_LDO_ITEM a JOIN  ECBOSS_LDO b
			ON a.LDO_ID = b.id
			AND 
				CUSTOMER_CODE=#customerCode#
			AND 
				WH_CODE=#warehouseCode#
			AND
				STATUS='WMS_CANCELED'
			AND 
				MODE_CODE='B2B'
			AND
				b.CREATE_TIME>=to_date(#startTime#,'yyyyMMdd')
			AND 
				b.CREATE_TIME<=(to_date(#endTime#,'yyyyMMdd'))
		]]>
		$param$
	</select>
	
	<select id="B2C_CANCEL_ORDER" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		<![CDATA[
			SELECT count(id) FROM ECBOSS_LDO_ITEM
			where LDO_ID in (
				SELECT id
					FROM
						ECBOSS_LDO
					WHERE 
							CUSTOMER_CODE=#customerCode#
						AND 
							WH_CODE=#warehouseCode#
						AND
							STATUS='WMS_CANCELED'
						AND 
							MODE_CODE='B2C'
						AND
							CREATE_TIME>=to_date(#startTime#,'yyyyMMdd')
						AND 
							CREATE_TIME<=(to_date(#endTime#,'yyyyMMdd'))
				)
		]]>
		$param$
	</select>
	
	<select id="B2C_CANCEL_ORDER_DISTINCT" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		<![CDATA[
			SELECT count(DISTINCT LDO_ID) FROM ECBOSS_LDO_ITEM
			where LDO_ID in (
				SELECT id
					FROM
						ECBOSS_LDO
					WHERE 
							CUSTOMER_CODE=#customerCode#
						AND 
							WH_CODE=#warehouseCode#
						AND
							STATUS='WMS_CANCELED'
						AND 
							MODE_CODE='B2C'
						AND
							CREATE_TIME>=to_date(#startTime#,'yyyyMMdd')
						AND 
							CREATE_TIME<=(to_date(#endTime#,'yyyyMMdd'))
				)
		]]>
		$param$
	</select>
	
	<select id="B2C_CANCEL_ORDER_DETAIL" parameterClass="java.util.Map" resultMap="DETAIL_OTHER_PROPERTIES">
		<![CDATA[
			SELECT LDO_ID AS LDO_ID,b.RELATION_NO AS REF_ORDER_CODE,b.SALESORDER_NO as ORDER_CODE,b.STATUS AS STATUS,to_char(b.CREATE_TIME,'yyyyMMdd') AS CREATE_TIME,to_char(b.SHIP_FINISH_TIME,'yyyyMMdd') AS SHIPPING_TIME,b.CONSIGNEE_PROVINCE AS PROVINCE,b.CONSIGNEE_CITY AS CITY,b.CONSIGNEE_CANTON_CODE AS DISTRICT,b.CONSIGNEE_ADDRESS AS ADDRESS,b.CONSIGNEE_LINKMANN AS "NAME", b.CONSIGNEE_PHONE AS PHONE,a.ORDER_LINE_NO AS ORDER_LINE_NO,b.ISSUE_PARTY_CODE AS ISSUE_PARTY_CODE,b.CUSTOMER_NAME AS CUSTOMER_NAME,b.OUTSIDE_NO AS OUTSIDE_NO,a.GROSS_WEIGHT AS GROSS_WEIGHT,a.CUBIC AS CUBIC,a.QTY_ORDERED AS QTY_ORDERED
			FROM ECBOSS_LDO_ITEM a JOIN  ECBOSS_LDO b
			ON a.LDO_ID = b.id
			AND 
				CUSTOMER_CODE=#customerCode#
			AND 
				WH_CODE=#warehouseCode#
			AND
				STATUS='WMS_CANCELED'
			AND 
				MODE_CODE='B2C'
			AND
				b.CREATE_TIME>=to_date(#startTime#,'yyyyMMdd')
			AND 
				b.CREATE_TIME<=(to_date(#endTime#,'yyyyMMdd'))
		]]>
		$param$
	</select>
	
	<select id="B2C_CANCEL_ORDER_DETAIL_DISTINCT" parameterClass="java.util.Map" resultMap="DETAIL_PROPERTIES">
		<![CDATA[
			SELECT DISTINCT LDO_ID AS LDO_ID,b.RELATION_NO AS REF_ORDER_CODE,b.SALESORDER_NO as ORDER_CODE,b.STATUS AS STATUS,to_char(b.CREATE_TIME,'yyyyMMdd') AS CREATE_TIME,to_char(b.SHIP_FINISH_TIME,'yyyyMMdd') AS SHIPPING_TIME,b.CONSIGNEE_PROVINCE AS PROVINCE,b.CONSIGNEE_CITY AS CITY,b.CONSIGNEE_CANTON_CODE AS DISTRICT,b.CONSIGNEE_ADDRESS AS ADDRESS,b.CONSIGNEE_LINKMANN AS "NAME", b.CONSIGNEE_PHONE AS PHONE
			FROM ECBOSS_LDO_ITEM a JOIN  ECBOSS_LDO b
			ON a.LDO_ID = b.id
			AND 
				CUSTOMER_CODE=#customerCode#
			AND 
				WH_CODE=#warehouseCode#
			AND
				STATUS='WMS_CANCELED'
			AND 
				MODE_CODE='B2C'
			AND
				b.CREATE_TIME>=to_date(#startTime#,'yyyyMMdd')
			AND 
				b.CREATE_TIME<=(to_date(#endTime#,'yyyyMMdd'))
		]]>
		$param$
	</select>
	
	<select id="B2C_ORDER_DETAIL" parameterClass="java.util.Map" resultMap="DETAIL_OTHER_PROPERTIES">
		<![CDATA[
			SELECT LDO_ID AS LDO_ID,b.RELATION_NO AS REF_ORDER_CODE,b.SALESORDER_NO as ORDER_CODE,b.STATUS AS STATUS,to_char(b.CREATE_TIME,'yyyyMMdd') AS CREATE_TIME,to_char(b.SHIP_FINISH_TIME,'yyyyMMdd') AS SHIPPING_TIME,b.CONSIGNEE_PROVINCE AS PROVINCE,b.CONSIGNEE_CITY AS CITY,b.CONSIGNEE_CANTON_CODE AS DISTRICT,b.CONSIGNEE_ADDRESS AS ADDRESS,b.CONSIGNEE_LINKMANN AS "NAME", b.CONSIGNEE_PHONE AS PHONE,a.ORDER_LINE_NO AS ORDER_LINE_NO,b.ISSUE_PARTY_CODE AS ISSUE_PARTY_CODE,b.CUSTOMER_NAME AS CUSTOMER_NAME,b.OUTSIDE_NO AS OUTSIDE_NO,a.GROSS_WEIGHT AS GROSS_WEIGHT,a.CUBIC AS CUBIC,a.QTY_ORDERED AS QTY_ORDERED
			FROM ECBOSS_LDO_ITEM a JOIN  ECBOSS_LDO b
			ON a.LDO_ID = b.id
			AND 
				CUSTOMER_CODE=#customerCode#
			AND 
				WH_CODE=#warehouseCode#
			AND
				STATUS='WMS_DELIVERED'
			AND 
				MODE_CODE='B2C'
			AND
				SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
			AND 
				SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
		]]>
		$param$
	</select>
	
	<select id="B2C_ORDER_DETAIL_DISTINCT" parameterClass="java.util.Map" resultMap="DETAIL_PROPERTIES">
		<![CDATA[
			SELECT DISTINCT LDO_ID AS LDO_ID,b.RELATION_NO AS REF_ORDER_CODE,b.SALESORDER_NO as ORDER_CODE,b.STATUS AS STATUS,to_char(b.CREATE_TIME,'yyyyMMdd') AS CREATE_TIME,to_char(b.SHIP_FINISH_TIME,'yyyyMMdd') AS SHIPPING_TIME,b.CONSIGNEE_PROVINCE AS PROVINCE,b.CONSIGNEE_CITY AS CITY,b.CONSIGNEE_CANTON_CODE AS DISTRICT,b.CONSIGNEE_ADDRESS AS ADDRESS,b.CONSIGNEE_LINKMANN AS "NAME", b.CONSIGNEE_PHONE AS PHONE
			FROM ECBOSS_LDO_ITEM a JOIN  ECBOSS_LDO b
			ON a.LDO_ID = b.id
			AND 
				CUSTOMER_CODE=#customerCode#
			AND 
				WH_CODE=#warehouseCode#
			AND
				STATUS='WMS_DELIVERED'
			AND 
				MODE_CODE='B2C'
			AND
				SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
			AND 
				SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
		]]>
		$param$
	</select>
	
	<select id="B2C_ORDER" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		<![CDATA[
			SELECT count(id) FROM ECBOSS_LDO_ITEM
			where LDO_ID in (
				SELECT id
					FROM
						ECBOSS_LDO
					WHERE 
							CUSTOMER_CODE=#customerCode#
						AND 
							WH_CODE=#warehouseCode#
						AND
							STATUS='WMS_DELIVERED'
						AND 
							MODE_CODE='B2C'
						AND
							SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
						AND 
							SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
				)
		]]>
		$param$
	</select>
	
	<select id="B2C_ORDER_DISTINCT" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		<![CDATA[
			SELECT count(DISTINCT LDO_ID) FROM ECBOSS_LDO_ITEM
			where LDO_ID in (
				SELECT id
					FROM
						ECBOSS_LDO
					WHERE 
							CUSTOMER_CODE=#customerCode#
						AND 
							WH_CODE=#warehouseCode#
						AND
							STATUS='WMS_DELIVERED'
						AND 
							MODE_CODE='B2C'
						AND
							SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
						AND 
							SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
				)
		]]>
		$param$
	</select>
	
	<select id="B2B_ORDER_DETAIL" parameterClass="java.util.Map" resultMap="DETAIL_OTHER_PROPERTIES">
		<![CDATA[
			SELECT LDO_ID AS LDO_ID,b.RELATION_NO AS REF_ORDER_CODE,b.SALESORDER_NO as ORDER_CODE,b.STATUS AS STATUS,to_char(b.CREATE_TIME,'yyyyMMdd') AS CREATE_TIME,to_char(b.SHIP_FINISH_TIME,'yyyyMMdd') AS SHIPPING_TIME,b.CONSIGNEE_PROVINCE AS PROVINCE,b.CONSIGNEE_CITY AS CITY,b.CONSIGNEE_CANTON_CODE AS DISTRICT,b.CONSIGNEE_ADDRESS AS ADDRESS,b.CONSIGNEE_LINKMANN AS "NAME", b.CONSIGNEE_PHONE AS PHONE,a.ORDER_LINE_NO AS ORDER_LINE_NO,b.ISSUE_PARTY_CODE AS ISSUE_PARTY_CODE,b.CUSTOMER_NAME AS CUSTOMER_NAME,b.OUTSIDE_NO AS OUTSIDE_NO,a.GROSS_WEIGHT AS GROSS_WEIGHT,a.CUBIC AS CUBIC,a.QTY_ORDERED AS QTY_ORDERED
			FROM ECBOSS_LDO_ITEM a JOIN  ECBOSS_LDO b
			ON a.LDO_ID = b.id
			AND 
				CUSTOMER_CODE=#customerCode#
			AND 
				WH_CODE=#warehouseCode#
			AND
				STATUS='WMS_DELIVERED'
			AND 
				MODE_CODE='B2B'
			AND
				SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
			AND 
				SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
		]]>
		$param$
	</select>
	
	<select id="B2B_ORDER_DETAIL_DISTINCT" parameterClass="java.util.Map" resultMap="DETAIL_PROPERTIES">
		<![CDATA[
			SELECT DISTINCT LDO_ID AS LDO_ID,b.RELATION_NO AS REF_ORDER_CODE,b.SALESORDER_NO as ORDER_CODE,b.STATUS AS STATUS,to_char(b.CREATE_TIME,'yyyyMMdd') AS CREATE_TIME,to_char(b.SHIP_FINISH_TIME,'yyyyMMdd') AS SHIPPING_TIME,b.CONSIGNEE_PROVINCE AS PROVINCE,b.CONSIGNEE_CITY AS CITY,b.CONSIGNEE_CANTON_CODE AS DISTRICT,b.CONSIGNEE_ADDRESS AS ADDRESS,b.CONSIGNEE_LINKMANN AS "NAME", b.CONSIGNEE_PHONE AS PHONE
			FROM ECBOSS_LDO_ITEM a JOIN  ECBOSS_LDO b
			ON a.LDO_ID = b.id
			AND 
				CUSTOMER_CODE=#customerCode#
			AND 
				WH_CODE=#warehouseCode#
			AND
				STATUS='WMS_DELIVERED'
			AND 
				MODE_CODE='B2B'
			AND
				SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
			AND 
				SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
		]]>
		$param$
	</select>
	
	<select id="B2B_ORDER" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		<![CDATA[
			SELECT count(id) FROM ECBOSS_LDO_ITEM
			where LDO_ID in (
				SELECT id
					FROM
						ECBOSS_LDO
					WHERE 
							CUSTOMER_CODE=#customerCode#
						AND 
							WH_CODE=#warehouseCode#
						AND
							STATUS='WMS_DELIVERED'
						AND 
							MODE_CODE='B2B'
						AND
							SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
						AND 
							SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
				)
		]]>
		$param$
	</select>
	
	<select id="B2B_ORDER_DISTINCT" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		<![CDATA[
			SELECT count(DISTINCT LDO_ID) FROM ECBOSS_LDO_ITEM
			where LDO_ID in (
				SELECT id
					FROM
						ECBOSS_LDO
					WHERE 
							CUSTOMER_CODE=#customerCode#
						AND 
							WH_CODE=#warehouseCode#
						AND
							STATUS='WMS_DELIVERED'
						AND 
							MODE_CODE='B2B'
						AND
							SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
						AND 
							SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
				)
		]]>
		$param$
	</select>
	
	<select id="360_B2C_ORDER_DETAIL" parameterClass="java.util.Map" resultMap="DETAIL_OTHER_PROPERTIES">
		<![CDATA[
			SELECT LDO_ID AS LDO_ID,b.RELATION_NO AS REF_ORDER_CODE,b.SALESORDER_NO as ORDER_CODE,b.STATUS AS STATUS,to_char(b.CREATE_TIME,'yyyyMMdd') AS CREATE_TIME,to_char(b.SHIP_FINISH_TIME,'yyyyMMdd') AS SHIPPING_TIME,b.CONSIGNEE_PROVINCE AS PROVINCE,b.CONSIGNEE_CITY AS CITY,b.CONSIGNEE_CANTON_CODE AS DISTRICT,b.CONSIGNEE_ADDRESS AS ADDRESS,b.CONSIGNEE_LINKMANN AS "NAME", b.CONSIGNEE_PHONE AS PHONE,a.ORDER_LINE_NO AS ORDER_LINE_NO,b.ISSUE_PARTY_CODE AS ISSUE_PARTY_CODE,b.CUSTOMER_NAME AS CUSTOMER_NAME,b.OUTSIDE_NO AS OUTSIDE_NO,a.GROSS_WEIGHT AS GROSS_WEIGHT,a.CUBIC AS CUBIC,a.QTY_ORDERED AS QTY_ORDERED
			FROM ECBOSS_LDO_ITEM a JOIN  ECBOSS_LDO b
			ON a.LDO_ID = b.id
			AND 
				CUSTOMER_CODE=#customerCode#
			AND 
				WH_CODE=#warehouseCode#
			AND
				STATUS='WMS_DELIVERED'
			AND 
				MODE_CODE='B2C'
			AND
				SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
			AND 
				SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
			AND 
				ISSUE_PARTY_CODE='360BUY'
		]]>
		$param$
	</select>
	
	<select id="360_B2C_ORDER_DETAIL_DISTINCT" parameterClass="java.util.Map" resultMap="DETAIL_PROPERTIES">
		<![CDATA[
			SELECT DISTINCT LDO_ID AS LDO_ID,b.RELATION_NO AS REF_ORDER_CODE,b.SALESORDER_NO as ORDER_CODE,b.STATUS AS STATUS,to_char(b.CREATE_TIME,'yyyyMMdd') AS CREATE_TIME,to_char(b.SHIP_FINISH_TIME,'yyyyMMdd') AS SHIPPING_TIME,b.CONSIGNEE_PROVINCE AS PROVINCE,b.CONSIGNEE_CITY AS CITY,b.CONSIGNEE_CANTON_CODE AS DISTRICT,b.CONSIGNEE_ADDRESS AS ADDRESS,b.CONSIGNEE_LINKMANN AS "NAME", b.CONSIGNEE_PHONE AS PHONE
			FROM ECBOSS_LDO_ITEM a JOIN  ECBOSS_LDO b
			ON a.LDO_ID = b.id
			AND 
				CUSTOMER_CODE=#customerCode#
			AND 
				WH_CODE=#warehouseCode#
			AND
				STATUS='WMS_DELIVERED'
			AND 
				MODE_CODE='B2C'
			AND
				SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
			AND 
				SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
			AND 
				ISSUE_PARTY_CODE='360BUY'
		]]>
		$param$
	</select>
	
	<select id="360_B2C_ORDER" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		<![CDATA[
			SELECT count(id) FROM ECBOSS_LDO_ITEM
			where LDO_ID in (
				SELECT id
					FROM
						ECBOSS_LDO
					WHERE 
							CUSTOMER_CODE=#customerCode#
						AND 
							WH_CODE=#warehouseCode#
						AND
							STATUS='WMS_CANCELED'
						AND 
							MODE_CODE='B2C'
						AND
							SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
						AND 
							SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
						AND 
							ISSUE_PARTY_CODE='360BUY'
				)
				
		]]>
		$param$
	</select>
	
	<select id="360_B2C_ORDER_DISTINCT" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		<![CDATA[
			SELECT count(DISTINCT LDO_ID) FROM ECBOSS_LDO_ITEM
			where LDO_ID in (
				SELECT id
					FROM
						ECBOSS_LDO
					WHERE 
							CUSTOMER_CODE=#customerCode#
						AND 
							WH_CODE=#warehouseCode#
						AND
							STATUS='WMS_CANCELED'
						AND 
							MODE_CODE='B2C'
						AND
							SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
						AND 
							SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
						AND 
							ISSUE_PARTY_CODE='360BUY'
				)
				
		]]>
		$param$
	</select>
	
	<select id="COMMODITY_DISTINCT" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		<![CDATA[
			SELECT SUM(a.QTY_ORDERED)
			FROM ECBOSS_LDO_ITEM a JOIN  ECBOSS_LDO b
			ON a.LDO_ID = b.id
			AND 
				CUSTOMER_CODE=#customerCode#
			AND 
				WH_CODE=#warehouseCode#
			AND
				STATUS='WMS_DELIVERED'
			AND
				SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
			AND 
				SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
		]]>
		$param$
	</select>
	
	<select id="COMMODITY_DETAIL" parameterClass="java.util.Map" resultMap="DETAIL_COMMODITY_PROPERTIES">
		<![CDATA[
			SELECT SALESORDER_NO AS LDO_ID,SUM(a.QTY_ORDERED) AS QTY_ORDERED
			FROM ECBOSS_LDO_ITEM a JOIN  ECBOSS_LDO b
			ON a.LDO_ID = b.id
			AND 
				CUSTOMER_CODE=#customerCode#
			AND 
				WH_CODE=#warehouseCode#
			AND
				STATUS='WMS_DELIVERED'
			AND
				SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
			AND 
				SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
		]]>
		$param$
		<![CDATA[
			GROUP BY LDO_ID
		]]>
	</select>
	
	<select id="TAOBAO_B2C_ORDER_DETAIL" parameterClass="java.util.Map" resultMap="DETAIL_OTHER_PROPERTIES">
		<![CDATA[
			SELECT LDO_ID AS LDO_ID,b.RELATION_NO AS REF_ORDER_CODE,b.SALESORDER_NO as ORDER_CODE,b.STATUS AS STATUS,to_char(b.CREATE_TIME,'yyyyMMdd') AS CREATE_TIME,to_char(b.SHIP_FINISH_TIME,'yyyyMMdd') AS SHIPPING_TIME,b.CONSIGNEE_PROVINCE AS PROVINCE,b.CONSIGNEE_CITY AS CITY,b.CONSIGNEE_CANTON_CODE AS DISTRICT,b.CONSIGNEE_ADDRESS AS ADDRESS,b.CONSIGNEE_LINKMANN AS "NAME", b.CONSIGNEE_PHONE AS PHONE,a.ORDER_LINE_NO AS ORDER_LINE_NO,b.ISSUE_PARTY_CODE AS ISSUE_PARTY_CODE,b.CUSTOMER_NAME AS CUSTOMER_NAME,b.OUTSIDE_NO AS OUTSIDE_NO,a.GROSS_WEIGHT AS GROSS_WEIGHT,a.CUBIC AS CUBIC,a.QTY_ORDERED AS QTY_ORDERED
			FROM ECBOSS_LDO_ITEM a JOIN  ECBOSS_LDO b
			ON a.LDO_ID = b.id
			AND 
				CUSTOMER_CODE=#customerCode#
			AND 
				WH_CODE=#warehouseCode#
			AND
				STATUS='WMS_DELIVERED'
			AND 
				MODE_CODE='B2C'
			AND
				SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
			AND 
				SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
			AND 
				ISSUE_PARTY_CODE='TAOBAO'
		]]>
		$param$
	</select>
	
	<select id="TAOBAO_B2C_ORDER_DETAIL_DISTINCT" parameterClass="java.util.Map" resultMap="DETAIL_PROPERTIES">
		<![CDATA[
			SELECT DISTINCT LDO_ID AS LDO_ID,b.RELATION_NO AS REF_ORDER_CODE,b.SALESORDER_NO as ORDER_CODE,b.STATUS AS STATUS,to_char(b.CREATE_TIME,'yyyyMMdd') AS CREATE_TIME,to_char(b.SHIP_FINISH_TIME,'yyyyMMdd') AS SHIPPING_TIME,b.CONSIGNEE_PROVINCE AS PROVINCE,b.CONSIGNEE_CITY AS CITY,b.CONSIGNEE_CANTON_CODE AS DISTRICT,b.CONSIGNEE_ADDRESS AS ADDRESS,b.CONSIGNEE_LINKMANN AS "NAME", b.CONSIGNEE_PHONE AS PHONE
			FROM ECBOSS_LDO_ITEM a JOIN  ECBOSS_LDO b
			ON a.LDO_ID = b.id
			AND 
				CUSTOMER_CODE=#customerCode#
			AND 
				WH_CODE=#warehouseCode#
			AND
				STATUS='WMS_DELIVERED'
			AND 
				MODE_CODE='B2C'
			AND
				SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
			AND 
				SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
			AND 
				ISSUE_PARTY_CODE='TAOBAO'
		]]>
		$param$
	</select>
	
	<select id="TAOBAO_B2C_ORDER" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		<![CDATA[
			SELECT count(id) FROM ECBOSS_LDO_ITEM
			where LDO_ID in (
				SELECT id
					FROM
						ECBOSS_LDO
					WHERE 
							CUSTOMER_CODE=#customerCode#
						AND 
							WH_CODE=#warehouseCode#
						AND
							STATUS='WMS_DELIVERED'
						AND 
							MODE_CODE='B2C'
						AND
							SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
						AND 
							SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
						AND 
							ISSUE_PARTY_CODE='TAOBAO'
				)
		]]>
		$param$
	</select>
	
	<select id="TAOBAO_B2C_ORDER_DISTINCT" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		<![CDATA[
			SELECT count(DISTINCT LDO_ID) FROM ECBOSS_LDO_ITEM
			where LDO_ID in (
				SELECT id
					FROM
						ECBOSS_LDO
					WHERE 
							CUSTOMER_CODE=#customerCode#
						AND 
							WH_CODE=#warehouseCode#
						AND
							STATUS='WMS_DELIVERED'
						AND 
							MODE_CODE='B2C'
						AND
							SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
						AND 
							SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
						AND 
							ISSUE_PARTY_CODE='TAOBAO'
				)
		]]>
		$param$
	</select>
	
	<select id="DANGDANG_B2C_ORDER" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		<![CDATA[
		SELECT count(id) FROM ECBOSS_LDO_ITEM
			where LDO_ID in (
				SELECT id
					FROM
						ECBOSS_LDO
					WHERE 
							CUSTOMER_CODE=#customerCode#
						AND 
							WH_CODE=#warehouseCode#
						AND
							STATUS='WMS_DELIVERED'
						AND 
							MODE_CODE='B2C'
						AND
							SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
						AND 
							SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
						AND 
							ISSUE_PARTY_CODE='DANGDANG'
				)
		]]>
		$param$
	</select>
	
	<select id="DANGDANG_B2C_ORDER_DISTINCT" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		<![CDATA[
		SELECT count(DISTINCT LDO_ID) FROM ECBOSS_LDO_ITEM
			where LDO_ID in (
				SELECT id
					FROM
						ECBOSS_LDO
					WHERE 
							CUSTOMER_CODE=#customerCode#
						AND 
							WH_CODE=#warehouseCode#
						AND
							STATUS='WMS_DELIVERED'
						AND 
							MODE_CODE='B2C'
						AND
							SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
						AND 
							SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
						AND 
							ISSUE_PARTY_CODE='DANGDANG'
				)
		]]>
		$param$
	</select>
	
	<select id="DANGDANG_B2C_ORDER_DETAIL" parameterClass="java.util.Map" resultMap="DETAIL_OTHER_PROPERTIES">
		<![CDATA[
			SELECT LDO_ID AS LDO_ID,b.RELATION_NO AS REF_ORDER_CODE,b.SALESORDER_NO as ORDER_CODE,b.STATUS AS STATUS,to_char(b.CREATE_TIME,'yyyyMMdd') AS CREATE_TIME,to_char(b.SHIP_FINISH_TIME,'yyyyMMdd') AS SHIPPING_TIME,b.CONSIGNEE_PROVINCE AS PROVINCE,b.CONSIGNEE_CITY AS CITY,b.CONSIGNEE_CANTON_CODE AS DISTRICT,b.CONSIGNEE_ADDRESS AS ADDRESS,b.CONSIGNEE_LINKMANN AS "NAME", b.CONSIGNEE_PHONE AS PHONE,a.ORDER_LINE_NO AS ORDER_LINE_NO,b.ISSUE_PARTY_CODE AS ISSUE_PARTY_CODE,b.CUSTOMER_NAME AS CUSTOMER_NAME,b.OUTSIDE_NO AS OUTSIDE_NO,a.GROSS_WEIGHT AS GROSS_WEIGHT,a.CUBIC AS CUBIC,a.QTY_ORDERED AS QTY_ORDERED
			FROM ECBOSS_LDO_ITEM a JOIN  ECBOSS_LDO b
			ON a.LDO_ID = b.id
			AND 
				CUSTOMER_CODE=#customerCode#
			AND 
				WH_CODE=#warehouseCode#
			AND
				STATUS='WMS_DELIVERED'
			AND 
				MODE_CODE='B2C'
			AND
				SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
			AND 
				SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
			AND 
				ISSUE_PARTY_CODE='DANGDANG'
		]]>
		$param$
	</select>
	
	<select id="DANGDANG_B2C_ORDER_DETAIL_DISTINCT" parameterClass="java.util.Map" resultMap="DETAIL_PROPERTIES">
		<![CDATA[
			SELECT DISTINCT LDO_ID AS LDO_ID,b.RELATION_NO AS REF_ORDER_CODE,b.SALESORDER_NO as ORDER_CODE,b.STATUS AS STATUS,to_char(b.CREATE_TIME,'yyyyMMdd') AS CREATE_TIME,to_char(b.SHIP_FINISH_TIME,'yyyyMMdd') AS SHIPPING_TIME,b.CONSIGNEE_PROVINCE AS PROVINCE,b.CONSIGNEE_CITY AS CITY,b.CONSIGNEE_CANTON_CODE AS DISTRICT,b.CONSIGNEE_ADDRESS AS ADDRESS,b.CONSIGNEE_LINKMANN AS "NAME", b.CONSIGNEE_PHONE AS PHONE
			FROM ECBOSS_LDO_ITEM a JOIN  ECBOSS_LDO b
			ON a.LDO_ID = b.id
			AND 
				CUSTOMER_CODE=#customerCode#
			AND 
				WH_CODE=#warehouseCode#
			AND
				STATUS='WMS_DELIVERED'
			AND 
				MODE_CODE='B2C'
			AND
				SHIP_FINISH_TIME>=to_date(#startTime#,'yyyyMMdd')
			AND 
				SHIP_FINISH_TIME<=(to_date(#endTime#,'yyyyMMdd'))
			AND 
				ISSUE_PARTY_CODE='DANGDANG'
		]]>
		$param$
	</select>
	
</sqlMap>
